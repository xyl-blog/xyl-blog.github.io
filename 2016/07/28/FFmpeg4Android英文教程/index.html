<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="ffmpeg," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="FFmpeg4Android is a way your application can run FFmpeg commands,  only Java, no need for C code, or NDK.">
<meta property="og:type" content="article">
<meta property="og:title" content="ffmpeg英文教程">
<meta property="og:url" content="http://yoursite.com/2016/07/28/FFmpeg4Android英文教程/index.html">
<meta property="og:site_name" content="xyl-blog">
<meta property="og:description" content="FFmpeg4Android is a way your application can run FFmpeg commands,  only Java, no need for C code, or NDK.">
<meta property="og:updated_time" content="2016-10-06T09:36:31.941Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ffmpeg英文教程">
<meta name="twitter:description" content="FFmpeg4Android is a way your application can run FFmpeg commands,  only Java, no need for C code, or NDK.">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 6263950864822568000,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2016/07/28/FFmpeg4Android英文教程/"/>

  <title> ffmpeg英文教程 | xyl-blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?69405dd561a0561e10fd03653d20cbdb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">xyl-blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">xyl-blog</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'sDJjoMPPTt5-xrjzZPT3','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                ffmpeg英文教程
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-28T13:38:05+08:00" content="2016-07-28">
              2016-07-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ffmpeg/" itemprop="url" rel="index">
                    <span itemprop="name">ffmpeg</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/28/FFmpeg4Android英文教程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/28/FFmpeg4Android英文教程/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/07/28/FFmpeg4Android英文教程/" class="leancloud_visitors" data-flag-title="ffmpeg英文教程">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>FFmpeg4Android is a way your application can run FFmpeg commands,  only Java, no need for C code, or NDK.<br><a id="more"></a></p>
<p>=== new ========</p>
<h1 id="New-version-25-24"><a href="#New-version-25-24" class="headerlink" title="New version 25.24"></a>New version 25.24</h1><p>Android Studio full demo with ffmpeg4android_lib<br>Download version 25.24 <a href="https://drive.google.com/file/d/0B9qAjo6wKhk9MEpNNjMxaG5oWXM/view?usp=sharing" target="_blank" rel="external">https://drive.google.com/file/d/0B9qAjo6wKhk9MEpNNjMxaG5oWXM/view?usp=sharing</a></p>
<p>Running FFmpeg4Android demo project (Android Studio)<br>Just Download the Android Studio project above, open the zip, build, and run to your device.<br>Add FFmpeg support to your app (Android Studio)<br>Simple Guide with screenshots <a href="https://docs.google.com/document/d/1FWMAT3FbCXlW_91d6Ek_UCD_CtYJWxYaDVY2hE6Onig/edit?usp=sharing" target="_blank" rel="external">https://docs.google.com/document/d/1FWMAT3FbCXlW_91d6Ek_UCD_CtYJWxYaDVY2hE6Onig/edit?usp=sharing</a></p>
<p>Commands Examples<br>This commands verified to work with FFmpeg4Android:<br>This are only some basic examples, a lot more is possible…</p>
<p>Video Compress:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">// simple regular commad </span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -s 160x120 -r 25 -vcodec mpeg4 -b 150k -ab 48000 -ac 2 -ar 22050 /sdcard/videokit/out.mp4</span><br><span class="line"> </span><br><span class="line">// compress with h264 (to support chrome)</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -vcodec libx264 -preset ultrafast -crf 24 -acodec aac -ar 44100 -ac 2 -b:a 96k -s 320x240 -aspect 4:3 /sdcard/videokit/out3.mp4</span><br><span class="line">// As complex command, don&apos;t forget to use setCommandComplex(complexCommand)</span><br><span class="line">// Use this format to support files that contains spaces and special characters</span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/video kit/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;,&quot;-s&quot;, &quot;160x120&quot;,&quot;-r&quot;,&quot;25&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;, &quot;-b&quot;, &quot;150k&quot;, &quot;-ab&quot;,&quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;, &quot;/sdcard/video kit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The parameters that control the quality are the -s (resolution, currently set on 160x120) and the -b (the bitrate, currently set on 150k).</span><br><span class="line">Increase them, e.g -s 480x320</span><br><span class="line">And -b 900k</span><br><span class="line">To improve quality (and get less compression).?</span><br><span class="line"></span><br><span class="line">Note that you will need to use the Extras (see below) distribution to use this command.</span><br><span class="line"> </span><br><span class="line">Audio Compression</span><br><span class="line"> </span><br><span class="line">String commandStr = &quot;ffmpeg -y -i /sdcard/vk2/in.wav -ar 44100 -ac 2 -ab 64k -f mp3 /sdcard/videokit/out.mp3&quot;;</span><br><span class="line"></span><br><span class="line">Audio Trim (Crop)</span><br><span class="line">String commandStr =&#123;&quot;ffmpeg&quot;,&quot;-y&quot;,&quot;-i&quot;,&quot;/storage/emulated/0/vk2/in.mp3&quot;,&quot;-strict&quot;,&quot;experimental&quot;,&quot;-acodec&quot;,&quot;copy&quot;,&quot;-ss&quot;,&quot;00:00:00&quot;,&quot;-t&quot;,&quot;00:00:03.000&quot;,&quot;/storage/emulated/0/videokit/out.mp3&quot;&#125;;</span><br><span class="line"> </span><br><span class="line">Video Rotate (90 degrees cw):</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -vf transpose=1 -s 160x120 -r 30 -aspect 4:3 -ab 48000 -ac 2 -ar 22050 -b 2097k /sdcard/video_output/out.mp4</span><br><span class="line"> </span><br><span class="line">Video Crop:</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/short.mp4 -strict experimental -vf crop=100:100:0:0 -s 320x240 -r 15 -aspect 3:4 -ab 12288 -vcodec mpeg4 -b 2097152 -sample_fmt s16 /sdcard/videokit/out.mp4</span><br><span class="line"> </span><br><span class="line">Extract Picture from Video:</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -an -r 1/2 -ss 00:00:00.000 -t 00:00:03 /sdcard/videokit/filename%03d.jpg</span><br><span class="line"> </span><br><span class="line">Extract Sound from Video:</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.avi -strict experimental -acodec copy /sdcard/videokit/out.mp3</span><br><span class="line"></span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -vn -ar 44100 -ac 2 -ab 256k -f mp3 /sdcard/videokit/out.mp3</span><br><span class="line"> </span><br><span class="line">Re-encode Audio in Video:</span><br><span class="line">ffmpeg -y -i /sdcard/in.mp4 -strict experimental -vcodec copy -acodec libmp3lame -ab 64k -ac 2 -b 1200000 -ar 22050 /sdcard/out.mp4</span><br><span class="line"></span><br><span class="line">Change Video Resolution:</span><br><span class="line">ffmpeg -y -i /sdcard/in.mp4 -strict experimental -vf transpose=3 -s 320x240 -r 15 -aspect 3:4 -ab 12288 -vcodec mpeg4 -b 2097152 -sample_fmt s16 /sdcard/out.mp4</span><br><span class="line"></span><br><span class="line">Cut time segment from Video:</span><br><span class="line">ffmpeg -ss 00:00:01.000 -y -i /sdcard/videokit/in.mp4 -strict experimental -t 00:00:02.000 -s 320x240 -r 15 -vcodec mpeg4 -b 2097152 -ab 48000 -ac 2 -b 2097152 -ar 22050 /sdcard/videokit/out.mp4</span><br><span class="line"></span><br><span class="line">Transcode Audio:</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/big.wav /sdcard/videokit/small.mp3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WaterMark:</span><br><span class="line"> //  test with watermark.png 128x128, add it to /sdcard/videokit/</span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;, &quot;-vf&quot;, &quot;movie=/sdcard/videokit/watermark.png [watermark]; [in][watermark] overlay=main_w-overlay_w-10:10 [out]&quot;,&quot;-s&quot;, &quot;320x240&quot;,&quot;-r&quot;, &quot;30&quot;, &quot;-b&quot;, &quot;15496k&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;,&quot;-ab&quot;, &quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;, &quot;/sdcard/videokit/out.mp4&quot;&#125;; </span><br><span class="line"></span><br><span class="line">Streaming simple:</span><br><span class="line"> </span><br><span class="line">* note that all streaming examples will need to add internet permission to the Android project Manifest file ( &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;  )</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">// use this command on ffmpeg4android</span><br><span class="line">ffmpeg -i /sdcard/videokit/2.mpg -strict experimental -f mpegts udp://192.168.0.114:8090</span><br><span class="line"></span><br><span class="line">// You can use any player that supports streaming, on the target machine, to play the stream, in this case we used ffplay</span><br><span class="line"></span><br><span class="line">ffplay -f mpegts -ast 1 -vst 0 -ar 48000 udp://192.168.0.114:8090</span><br></pre></td></tr></table></figure></p>
<p>STREAM RAW VIDEO FROM CAMERA PREVIEW:</p>
<p>GETTING THE RAW STREAM FROM THE CAMERA PREVIEW:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Parameters parameters = camera.getParameters();</span><br><span class="line">imageFormat = parameters.getPreviewFormat();</span><br><span class="line"><span class="keyword">if</span> (imageFormat == ImageFormat.NV21) &#123;</span><br><span class="line">                Camera.Size previewSize = parameters.getPreviewSize();</span><br><span class="line">                frameWidth = previewSize.width;</span><br><span class="line">                frameHeight = previewSize.height;</span><br><span class="line">                Rect rect = <span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">0</span>, frameWidth, frameHeight);</span><br><span class="line">                YuvImage img = <span class="keyword">new</span> YuvImage(data, ImageFormat.NV21, frameWidth, frameHeight, <span class="keyword">null</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                                outStream.write(data);</span><br><span class="line">                                outStream.flush();</span><br><span class="line">                &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ENCODE AND STREAM USING FFMPEG4ANDROID:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;ffmpeg -f rawvideo -pix_fmt nv21 -s 640x480 -r 15 -i &quot; + Environment.getExternalStorageDirectory().getAbsolutePath().toString() + &quot;/yuv.data rtmp://host/stream.flv&quot;</span><br></pre></td></tr></table></figure></p>
<p>STREAM ON ONE DEVICE, RECEIVE A STEAM ON SECOND DEVICE AND SAVE IT:<br>on the first device:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i /sdcard/one3.mp4 -f mpegts udp://192.168.0.107:8090</span><br></pre></td></tr></table></figure></p>
<p>on the second device:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;udp://192.168.0.108:8090&quot;,&quot;-strict&quot;,&quot;experimental&quot;,&quot;-crf&quot;, &quot;30&quot;,&quot;-preset&quot;, &quot;ultrafast&quot;, &quot;-acodec&quot;, &quot;aac&quot;, &quot;-ar&quot;, &quot;44100&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-b:a&quot;, &quot;96k&quot;, &quot;-vcodec&quot;, &quot;libx264&quot;, &quot;-r&quot;, &quot;25&quot;, &quot;-b:v&quot;, &quot;500k&quot;, &quot;-f&quot;, &quot;flv&quot;, &quot;/sdcard/videokit/t.flv&quot;&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>this needs internet permission in the manifest. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">H264 encoding:</span><br><span class="line">ffmpeg -y -i /sdcard/Video/1.MTS -strict experimental -vcodec libx264 -preset ultrafast -crf 24 /sdcard/videokit/out.mp4</span><br><span class="line"></span><br><span class="line">ffmpeg -y -i /sdcard/videokit/m.mkv -strict experimental -vcodec libx264 -preset ultrafast -crf 24 -sn /sdcard/videokit/m2.mkv</span><br><span class="line"></span><br><span class="line">Subtitles:</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/m2.mkv -i /sdcard/videokit/in.srt -strict experimental -vcodec libx264 -preset ultrafast -crf 24 -scodec copy /sdcard/videokit/mo.mkv</span><br><span class="line"></span><br><span class="line">ffmpeg -y -i /sdcard/videokit/m2.mkv -i /sdcard/videokit/in.srt -strict experimental -scodec copy /sdcard/videokit/outm3.mkv</span><br><span class="line"></span><br><span class="line">Convert Audio file to m4a</span><br><span class="line">ffmpeg -i /sdcard/videokit/in.mp3 /sdcard/videokit/out.m4a</span><br><span class="line"></span><br><span class="line">Encode h264 video and aac audio in one command</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -vcodec libx264 -crf 24 -acodec aac /sdcard/videokit/out.mkv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Vintage filter</span><br><span class="line"></span><br><span class="line">commandStr = &quot;ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -vf curves=vintage -s 640x480 -r 30 -aspect 4:3 -ab 48000 -ac 2 -ar 22050 -b 2097k -vcodec mpeg4 /sdcard/videokit/curve.mp4&quot;;</span><br><span class="line"></span><br><span class="line">Black &amp; White filter (Gray Scale):</span><br><span class="line"></span><br><span class="line">commandStr = &quot;ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -vf hue=s=0 -vcodec mpeg4 -b 2097152 -s 320x240 -r 30 /sdcard/videokit/out.mp4&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Sepia using colorchannelmixer</span><br><span class="line"></span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/sample.mp4&quot;,&quot;-strict&quot;, &quot;experimental&quot;, &quot;-filter_complex&quot;,</span><br><span class="line">&quot;[0:v]colorchannelmixer=.393:.769:.189:0:.349:.686:.168:0:.272:.534:.131[colorchannelmixed];[colorchannelmixed]eq=1.0:0:1.3:2.4:1.0:1.0:1.0:1.0[color_effect]&quot;,</span><br><span class="line"> &quot;-map&quot;, &quot;[color_effect]&quot;,&quot;-map&quot;, &quot;0:a&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;,&quot;-b&quot;, &quot;15496k&quot;, &quot;-ab&quot;, &quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;,&quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line">Create filter using Photoshop curves </span><br><span class="line"></span><br><span class="line">You can create some effects using Photoshop curves operation (Image, Adjustments, Curves (CNTL + M)), export the curves acv file, and apply it using this command:</span><br><span class="line"></span><br><span class="line">String[]</span><br><span class="line">complexCommand=&#123;&quot;ffmpeg&quot;,&quot;-y&quot;,&quot;-i&quot;,&quot;/storage/emulated/0/vk2/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;,&quot;-vf&quot;,&quot;curves=psfile=/storage/emulated/0/videokit/sepia.acv&quot;,&quot;-b&quot;,&quot;2097k&quot;,&quot;-vcodec&quot;,&quot;mpeg4&quot;,&quot;-ab&quot;,&quot;48000&quot;,&quot;-ac&quot;,&quot;2&quot;,&quot;-ar&quot;,&quot;22050&quot;,&quot;/storage/emulated/0/videokit/out.mp4&quot;&#125;?</span><br><span class="line"></span><br><span class="line">Fade in and out transition</span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/in.m4v&quot;,&quot;-acodec&quot;, &quot;copy&quot;, &quot;-vf&quot;, &quot;fade=t=in:st=0:d=5, fade=t=out:st=20:d=5&quot;, &quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Join 2 files using of the same size using filter_complex</span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot;,&quot;-i&quot;, &quot;/sdcard/videokit/in1.mp4&quot;, &quot;-i&quot;, &quot;/sdcard/videokit/in2.mp4&quot;, &quot;-strict&quot;,&quot;experimental&quot;, &quot;-filter_complex&quot;, &quot;[0:0] [0:1] [1:0] [1:1] concat=n=2:v=1:a=1&quot;, &quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// concat videos with different codecs, and different sizes, different rate and different aspect ratio:</span><br><span class="line"></span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot;,&quot;-i&quot;,&quot;/storage/emulated/0/videokit/sample.mp4&quot;,</span><br><span class="line">    &quot;-i&quot;,&quot;/storage/emulated/0/videokit/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;,</span><br><span class="line">    &quot;-filter_complex&quot;,</span><br><span class="line">    &quot;[0:v]scale=640x480,setsar=1:1[v0];[1:v]scale=640x480,setsar=1:1[v1];[v0][0:a][v1][1:a] concat=n=2:v=1:a=1&quot;,</span><br><span class="line">    &quot;-ab&quot;,&quot;48000&quot;,&quot;-ac&quot;,&quot;2&quot;,&quot;-ar&quot;,&quot;22050&quot;,&quot;-s&quot;,&quot;640x480&quot;,&quot;-r&quot;,&quot;30&quot;,&quot;-vcodec&quot;,&quot;mpeg4&quot;,&quot;-b&quot;,&quot;2097k&quot;,&quot;/storage/emulated/0/vk2_out/out.mp4&quot;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Create a video from pictures</span><br><span class="line"></span><br><span class="line">// note that this commans is sensative to the pictures size.</span><br><span class="line">// all pictures should be with the same size, and correspond to s peticular video resolution.</span><br><span class="line">// e.g hd video is: 1280x720, and this should be the pictures size </span><br><span class="line">commandStr = &quot;ffmpeg -y -r 1/5 -i /sdcard/videokit/pic00%d.jpg /sdcard/videokit/out.mp4&quot;;</span><br><span class="line"></span><br><span class="line">Advanced filtering</span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;, &quot;-vf&quot;, &quot;crop=iw/2:ih:0:0,split[tmp],pad=2*iw[left]; [tmp]hflip[right]; [left][right] overlay=W/2&quot;, &quot;-vb&quot;, &quot;20M&quot;, &quot;-r&quot;, &quot;23.956&quot;, &quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line">Increase video and audio speed</span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;, &quot;-filter_complex&quot;, &quot;[0:v]setpts=0.5*PTS[v];[0:a]atempo=2.0[a]&quot;,&quot;-map&quot;,&quot;[v]&quot;,&quot;-map&quot;,&quot;[a]&quot;, &quot;-b&quot;, &quot;2097k&quot;,&quot;-r&quot;,&quot;60&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;, &quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line">Overlay 2 videos side by side</span><br><span class="line"> </span><br><span class="line">     String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/Movies/sample.mp4&quot;,&quot;-i&quot;, &quot;/sdcard/Movies/sample2.mp4&quot;, &quot;-strict&quot;,&quot;experimental&quot;,</span><br><span class="line">                &quot;-filter_complex&quot;, </span><br><span class="line">                &quot;[0:v:0]pad=iw*2:ih[bg];&quot; + </span><br><span class="line">                &quot;[bg][1:v:0]overlay=w&quot;,</span><br><span class="line">                &quot;-s&quot;, &quot;320x240&quot;,&quot;-r&quot;, &quot;30&quot;, &quot;-b&quot;, &quot;15496k&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;,&quot;-ab&quot;, &quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;,</span><br><span class="line">                &quot;/sdcard/videokit/out.mp4&quot;&#125;;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  vintage + watermark</span><br><span class="line"> </span><br><span class="line">      String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/Movies/sample.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;,</span><br><span class="line">                &quot;-vf&quot;, </span><br><span class="line">                &quot;movie=/sdcard/videokit/watermark002.png [watermark];&quot; + </span><br><span class="line">                &quot;[in][watermark] overlay=main_w-overlay_w-10:10 [out_overlay];&quot; +</span><br><span class="line">                &quot;[out_overlay]curves=vintage[out]&quot;,  </span><br><span class="line">                &quot;-s&quot;, &quot;320x240&quot;,&quot;-r&quot;, &quot;30&quot;, &quot;-b&quot;, &quot;15496k&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;,&quot;-ab&quot;, &quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;,</span><br><span class="line">                &quot;/sdcard/videokit/out_water_vinta.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Watermark + audio replace</span><br><span class="line"> </span><br><span class="line">    String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/Movies/sample.mp4&quot;,&quot;-i&quot;, &quot;/sdcard/videokit/in.mp3&quot;, &quot;-strict&quot;,&quot;experimental&quot;,</span><br><span class="line">                &quot;-filter_complex&quot;,</span><br><span class="line">                &quot;[1:a]atempo=1.0[a1];&quot; +</span><br><span class="line">                &quot;movie=/sdcard/videokit/watermark002.png [watermark];&quot; + </span><br><span class="line">                &quot;[0:v][watermark] overlay=main_w-overlay_w-10:10 [outv]&quot;,</span><br><span class="line">                &quot;-map&quot;, &quot;[outv]&quot;, &quot;-map&quot;, &quot;[a1]&quot;,</span><br><span class="line">                &quot;-s&quot;, &quot;320x240&quot;,&quot;-r&quot;, &quot;30&quot;, &quot;-b&quot;, &quot;15496k&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;,&quot;-ab&quot;, &quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;,</span><br><span class="line">                &quot;-shortest&quot;,&quot;/sdcard/videokit/out_water.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line">Looping on a picture and adding audio with audio encoding support</span><br><span class="line">  </span><br><span class="line">      String commandStr = &quot;ffmpeg -y -loop 1 -i /sdcard/videokit/pic001.jpg -i /sdcard/videokit/in.mp3 -strict experimental -s 1270x720 -r 25 -aspect 16:9 -vcodec mpeg4 -vcodec mpeg4 -ab 48000 -ac 2 -b 2097152 -ar 22050 -shortest /sdcard/videokit/out2.mp4&quot;;</span><br><span class="line"></span><br><span class="line">Replacing video audio track, using the shotest (video or audio)</span><br><span class="line"></span><br><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/sample.mp4&quot;,&quot;-i&quot;, &quot;/sdcard/videokit/in.mp3&quot;, &quot;-strict&quot;,&quot;experimental&quot;,</span><br><span class="line">                &quot;-map&quot;, &quot;0:v&quot;, &quot;-map&quot;, &quot;1:a&quot;,</span><br><span class="line">                &quot;-s&quot;, &quot;320x240&quot;,&quot;-r&quot;, &quot;30&quot;, &quot;-b&quot;, &quot;15496k&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;,&quot;-ab&quot;, &quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;,&quot;-shortest&quot;,&quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line">Animated GIF</span><br><span class="line"></span><br><span class="line">//Compress animated gif:</span><br><span class="line">fmpeg -f gif -i /sdcard/videokit/pic1.gif -strict experimental -r 10 /sdcard/videokit/pic1_1.gif</span><br><span class="line"></span><br><span class="line">//Convert mp4 to animated gif:</span><br><span class="line">ffmpeg -y -i /sdcard/videokit/in.mp4 -strict experimental -r 20 /sdcard/videokit/out.gif</span><br><span class="line"></span><br><span class="line">//Convert animated gif to mp4:</span><br><span class="line">ffmpeg -y -f gif -i /sdcard/videokit/infile.gif /sdcard/videokit/outfile.mp4</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>ARM64-v8a support</p>
<p>Arm64-v8a is part of the extras (see related section).</p>
<p>Note that although many devices claim they have 64bit support, they don’t.<br>To verify a device does use arm64 architecture, open telnet on the device (or use adb), then run:</p>
<p>getprop ro.product.cpu.abi</p>
<p>if you get: armv7a, then you have 32bit architecture.<br>if you get: arm64-v8a, then you have 64bit architecture.</p>
<p>Using complex commands</p>
<p>A complex command is a command that contains embedded elements (in most cases it uses quotations for that.<br>Here is an example:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i /sdcard/videokit/in.mp4 -aspect 1:1 -vf split &quot;[main][tmp];[tmp] crop=iw/2:ih:0:0, hflip[tp],[tp] pad=2*iw[left]; [main] crop=iw/2:ih:iw/2:0[right]; [left][right] overlay=W/2&quot; -vb 20M -r 23.956 /sdcard/videokit/outs.mp4</span><br></pre></td></tr></table></figure></p>
<p>To set a complex command you should create a String array and use the method:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setCommandComplex()</span><br></pre></td></tr></table></figure></p>
<p>Like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/videokit/mo.mkv&quot;,&quot;-strict&quot;,&quot;experimental&quot;, &quot;-vf&quot;, &quot;crop=iw/2:ih:0:0,split[tmp],pad=2*iw[left]; [tmp]hflip[right]; [left][right] overlay=W/2&quot;, &quot;-vb&quot;, &quot;20M&quot;, &quot;-r&quot;, &quot;23.956&quot;, &quot;/sdcard/videokit/out.mp4&quot;&#125;;</span><br><span class="line"></span><br><span class="line">setCommandComplex(complexCommand);</span><br></pre></td></tr></table></figure></p>
<p>Size Tuning - Keeping your app apk small<br>FFmpeg4Android lib contains a build specifically to tackle this issue - Small App Size.<br>This build contains a subset of FFmpeg4Android that contains features (filters, coders, encoders, muxers etc), That are the most commonly used - the “essentials build”.<br>This build is great for apps that need to keep small size.<br>All the performance benefits of the full ffmpeg4android are kept.</p>
<p>To use this build, goto ffmpeg_lib libs/armeabi-v7a folder,<br>simply rename libvideokit.so to libvideokit.so.full,<br> and rename libvideokit.so.ess to libvideokit.so<br>Refresh the ffmpeg_lib project, and build your project (that use the ffmpeg_lib).<br>Your project will now use the essentials build, and you will see that the apk created is much smaller in size.</p>
<p>You can also remove the  libs/x86 folder, x86 devices will still work using the Houdini ARM real time translation, of course it will be slower then using the native.</p>
<p>You can also remove the libs/arm64-v8a folder since currently most devices does not support this platform, and all that do have backward compatibility with armeabi-v7a.</p>
<p>Make sure you test and see that all the functionality you need is still there.</p>
<p>Performance Tuning<br>Prefer mpeg4 codec (-codec mpeg4), since with this codec, ffmpeg4android can utilize all device cores.<br>Here is an example of command that use mpeg4 codec (in this case this command is doing a video compression):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String[] complexCommand = &#123;&quot;ffmpeg&quot;,&quot;-y&quot; ,&quot;-i&quot;, &quot;/sdcard/video kit/in.mp4&quot;,&quot;-strict&quot;,&quot;experimental&quot;,&quot;-s&quot;, &quot;160x120&quot;,&quot;-r&quot;,&quot;25&quot;, &quot;-vcodec&quot;, &quot;mpeg4&quot;, &quot;-b&quot;, &quot;150k&quot;, &quot;-ab&quot;,&quot;48000&quot;, &quot;-ac&quot;, &quot;2&quot;, &quot;-ar&quot;, &quot;22050&quot;, &quot;/sdcard/video kit/out.mp4&quot;&#125;;</span><br></pre></td></tr></table></figure></p>
<p>If its possible, reduce output video resolution (-s) and bitrate (-b), the lower the video quality is, the faster it will take to produce.<br>Encoding using h264 can’t utilize all device cores, and thus is much slower. If you must use it, use the -preset ultrafast flag.<br>Using the -threads flag can only degrade the performance, as ffmpeg4android automatically detects the number of cores your device has, and set the optimal number of threads for the command used.<br>Extras<br>Contains extra functionality that is not part of the standard distribution.<br>Download<br>x264 encoding support.<br>   To use it, download the extras distribution, extract it, it will look like this:<br>   – libs<br>     – armeabi-v7a<br>         – libvideokit.so.full_with_x264<br>     – x86<br>          – libvideokit.so.full_with_x264<br>    Copy the libvideokit.so.full_with_x264 to the ffmpeg4android_lib/libs to the coresponding architecture folder. Rename it to libvideokit.so, (replacing your current libvideokit.so).</p>
<p>Note that you must change your project manifest (not the lib manifest) to target api 22 or below, or the library will crash on Android 6 and above devices.</p>
<p>x86 Support<br>The standard Distribution is using Houdini Runtime ARM Intel translation.<br>To use native x86 follow the above (x264) explanations to copy the x86 so files.<br>This will also make it possible to run on x86 fast emulator (which does not have Houdini support).<br>You need to add the abiFilter “x86” in your project module defaultConfig:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">defaultConfig &#123;</span><br><span class="line">    applicationId &quot;com.examples.ffmpeg4android_demo&quot;    </span><br><span class="line">    minSdkVersion 16   </span><br><span class="line">    targetSdkVersion 23    </span><br><span class="line">    ndk &#123;</span><br><span class="line">        abiFilter &quot;armeabi-v7a&quot;        </span><br><span class="line">        abiFilter &quot;x86&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Note that you must change your project manifest (not the lib manifest) to target api 22 or below, or the library will crash on Android 6 and above devices.<br>arm64-v8a<br>The same as the x86 support, just add the “abiFilter arm64-v8a”<br>Note that we don’t recommend using this as our tests showed no significant performance improvement<br>from armeabi-v7a<br>FFmpeg Command Correctness<br>FFmpeg command can be quite complex, and in some cases, getting it right can be hard.<br>To help you with that, FFmpeg4Android will create a file called vk.log that contains the ffmpeg log in the device demo folder (by default /sdcard/videokit) This log can be very useful when understanding what is wrong with the FFmpeg command, and in most cases it will pinpoint you to the section in the command that is wrong.<br>If you still don’t understand what is wrong with your command, make sure the command works on a windows machine, and you can email us the command for inspection.</p>
<p>Known issues &amp; TroubleShooting</p>
<ul>
<li>x264 encoding was moved to the extras, so using this encoder will throw CommandValidationException.<br>Its recommended to use the mpeg4 encoder instead, its much faster.<br>If you still need to use the x264 encoding, read the extras section to understand how to add it to your project.</li>
</ul>
<ul>
<li>If you use only armeabi-v7a you must make sure all your other JNI libs are restricted to this architecture,  If not the loader will fail to find the library so file (it will try to find it in x64 folders).<br>To do it, add this configuration in your module build.gradle (under defaultConfig):<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ndk &#123;</span><br><span class="line">    abiFilter &quot;armeabi-v7a&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Latest version release notes</p>
<h2 id="25-24"><a href="#25-24" class="headerlink" title="25.24"></a>25.24</h2><p>Patch 6</p>
<ul>
<li>Simple example android 6 fix.</li>
<li>MultipleCommandsExample crash fix.</li>
<li>Version code fix.</li>
</ul>
<p>Patch 4</p>
<ul>
<li>Removed x86 (moved to extras).</li>
<li><p>abiFilter “x86” commented out</p>
</li>
<li><p>arm64-v8a moved to extras</p>
</li>
<li>Fixed more issues related Android 6.</li>
<li><p>Loader improvements.</p>
</li>
<li><p>Support for targeting api 23 and above.</p>
</li>
<li>Performance and size improvements.</li>
<li>ess size reduced and added support for fade filter and image2 demuxer<br>to support creation of video from images.</li>
<li>Support for x264 detection in the validation mechanism.</li>
<li>x264 encoding support is moved to extras,</li>
</ul>

      
    </div>


    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ffmpeg/" rel="tag">#ffmpeg</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/28/FFmpeg4Android中文参数/" rel="next" title="ffmpeg参数说明">
                <i class="fa fa-chevron-left"></i> ffmpeg参数说明
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/06/xposed-experience/" rel="prev" title="Xposed Hook使用">
                Xposed Hook使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>

    <div>
      
        
      
    </div>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/07/28/FFmpeg4Android英文教程/"
     data-title="ffmpeg英文教程"
     data-content=""
     data-url="http://yoursite.com/2016/07/28/FFmpeg4Android英文教程/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          

  <p>热评文章</p>
  <div class="ds-top-threads" data-range="weekly" data-num-items="4"></div>


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/07/28/FFmpeg4Android英文教程/"
           data-title="ffmpeg英文教程" data-url="http://yoursite.com/2016/07/28/FFmpeg4Android英文教程/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/logo.png"
               alt="xyl" />
          <p class="site-author-name" itemprop="name">xyl</p>
          <p class="site-description motion-element" itemprop="description">xyl个人网站</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">21</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/liang55" target="_blank" title="github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/577008004" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/_xyl" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/youl.xiong" target="_blank" title="facebook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  facebook
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://play.google.com/store/apps/details?id=com.anjoyo.xyl.run" target="_blank" title="google">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  google
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#New-version-25-24"><span class="nav-number">1.</span> <span class="nav-text">New version 25.24</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#25-24"><span class="nav-number">1.1.</span> <span class="nav-text">25.24</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xyl</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
    
        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"xyl-blog"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  






  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("vJrqFORgAlXG0sDsjErR2kap-gzGzoHsz", "Tb1YhTnA02XSBLX3EQLes5Qg");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
